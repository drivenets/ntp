Description: fix DoS via mode 6 packet
Origin: backport, http://bk.ntp.org/ntp-stable/?PAGE=cset&REV=59e033aeB4GEMXOx6d1EF6zRwQSFYA
Bug: http://support.ntp.org/bin/view/Main/NtpBug3412

Index: ntp-4.2.8p10+dfsg/ntpd/ntp_control.c
===================================================================
--- ntp-4.2.8p10+dfsg.orig/ntpd/ntp_control.c	2017-03-21 09:04:21.000000000 -0400
+++ ntp-4.2.8p10+dfsg/ntpd/ntp_control.c	2018-07-06 14:52:28.953595289 -0400
@@ -3095,7 +3095,9 @@ ctl_getitem(
 			const char *sp1 = reqpt;
 			const char *sp2 = v->text;
 
-			while ((sp1 != tp) && (*sp1 == *sp2)) {
+			/* [Bug 3412] do not compare past NUL byte in name */
+			while (   (sp1 != tp)
+			       && ('\0' != *sp2) && (*sp1 == *sp2)) {
 				++sp1;
 				++sp2;
 			}
